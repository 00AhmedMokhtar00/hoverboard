<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="call-to-action">
    <template>
        <style include="shared-styles">
            :host {
                display: block;
                background: var(--default-primary-color);
                color: var(--text-primary-color);
            }

            .heading {
                margin-bottom: 0 !important;
            }

            @media (max-width: 960px) {
                .open-dialog-button {
                    margin-top: 10px;
                }
            }

            @media (min-width: 961px) {
                .heading {
                    text-align: left;
                }
            }
        </style>
        <div class="container container-narrow flex relative layout vertical-horizontal center-center">
            <h4 class="heading flex self-center text-center">{$ callToAction.text $}</h4>
            <paper-button class="border-button open-dialog-button" on-tap="playVideo">{$ callToAction.buttonText $}</paper-button>
        </div>
        <paper-dialog class="full-dialog fit" id="videoDialog" modal entry-animation="scale-up-animation" exit-animation="fade-out-animation">
            <paper-toolbar class="navbar-overlay fit">
                <paper-icon-button icon="icons:arrow-back" on-tap="closeVideoCard"></paper-icon-button>
                <div class="title text-left">{$ callToAction.video.title $}</div>
            </paper-toolbar>
            <div class="full-container fit">
                <google-youtube id="video" video-id="{$ callToAction.video.id $}" fluid="true" autohide="1" chromeless="true"></google-youtube>
            </div>
        </paper-dialog>
    </template>
    <script>
        (function() {
            'use strict';

            class CallToAction {
                beforeRegister() {
                    let is = this.constructor.name.replace(/\W+/g, '-')
                        .replace(/([a-z\d])([A-Z])/g, '$1-$2').toLowerCase();
                    this.is = is;
                }
                playVideo() {
                    this.fire('iron-signal', {
                        name: 'track-event',
                        data: {
                            category: 'button',
                            action: 'click',
                            label: 'play-2014-video',
                            value: 1
                        }
                    });
                    this.$.videoDialog.open();
                    this.$.video.play();
                }
                closeVideoCard() {
                    this.$.videoDialog.close();
                    this.$.video.pause();
                    this.$.video.seekTo(0);
                }
            }

            Polymer(CallToAction);
        })();
    </script>
</dom-module>
