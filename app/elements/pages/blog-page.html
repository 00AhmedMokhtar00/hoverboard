<link rel="import" href="../../../bower_components/polymer/polymer.html">

<link rel="import" href="../../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../../bower_components/iron-image/iron-image.html">
<link rel="import" href="../../../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../../../bower_components/iron-image/iron-image.html">
<link rel="import" href="../../../bower_components/paper-material/paper-material.html">
<link rel="import" href="../../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../../bower_components/marked-element/marked-element.html">

<link rel="import" href="../behaviors/cascaded-animation-behavior.html">

<dom-module id="blog-page">
    <template>
        <style>
            :host {
                display: block;
                --grid-column-width: 396px;
                --grid-gutter: 4px;
                --grid-item-height: calc(3 * var(--grid-column-width) / 4);
            }

            .container {
                @apply(--layout-horizontal);
                @apply(--layout-wrap);
                max-width: calc(2 * var(--grid-column-width) + 4 * var(--grid-gutter));
                margin: var(--grid-gutter) auto;
            }

            .post {
                @apply(--layout-vertical);
                width: var(--grid-column-width);
                height: var(--grid-item-height);
                margin: var(--grid-gutter);
                text-decoration: none;
            }

            .post:first-of-type {
                width: calc(100% - 2 * var(--grid-gutter));
                height: calc(var(--grid-column-width) + 2 * var(--grid-gutter));
            }

            .image {
                height: 100%;
                width: 100%;
                background-size: cover;
                background-position: 50% 50%;
                background-repeat: no-repeat;
            }

            .title {
                @apply(--layout-horizontal);
                @apply(--layout-center-center);
                padding: 12px;
                min-height: 42px;
                font-size: 20px;
                text-align: center;
                letter-spacing: .8px;
                line-height: 1.05;
                color: #fff;
            }

            @media (max-width: 960px) {
                :host .container {
                    max-width: none;
                    padding: 0 var(--grid-gutter);
                }

                :host .post {
                    width: 100% !important;
                    height: var(--grid-item-height) !important;
                    margin: var(--grid-gutter) 0;
                }
            }

        </style>
        <div class="container">
            <template is="dom-repeat" items="[[posts]]" as="post" on-dom-change="_updateCascadedNodes">
                <a href="#" class="post" cascaded>
                    <iron-image class="image" src="[[post.image]]" style$="background-color: [[post.primaryColor]];"
                                sizing="cover" preload fade></iron-image>
                    <div class="title" style$="background-color: [[post.secondaryColor]];">[[post.title]]</div>
                </a>
            </template>
        </div>
    </template>
</dom-module>

<script>

    (function () {
        'use strict';

        Polymer({

            is: 'blog-page',

            behaviors: [
                Polymer.NeonSharedElementAnimatableBehavior,
                Polymer.CascadedAnimationBehavior
            ],

            properties: {
                posts: Array,

//                animationConfig: {
//                    type: Object,
//                    value: function () {
//                        return {
//                            'entry': [{
//                                name: 'cascaded-animation',
//                                animation: 'transform-animation',
//                                transformFrom: 'translate3d(0,100%,0)',
//                                transformTo: 'none',
//                                timing: {
//                                    delay: 0
//                                }
//                            }, {
//                                name: 'cascaded-animation',
//                                animation: 'fade-in-animation',
//                                timing: {
//                                    delay: 0
//                                }
//                            }],
//                            'exit': [{
//                                name: 'cascaded-animation',
//                                animation: 'transform-animation',
//                                transformFrom: 'translate3d(0,0,0)',
//                                transformTo: 'translate3d(0,100%,0)',
//                                timing: {
//                                    delay: 0
//                                }
//                            }, {
//                                name: 'cascaded-animation',
//                                animation: 'fade-out-animation',
//                                timing: {
//                                    delay: 0
//                                }
//                            }]
//                        };
//                    }
//                }
            }

        });

//        Doesn't work for now..

//        class BlogPage {
//
//            get behaviors() {
//                return [Polymer.CascadedAnimationBehavior];
//            }
//
//            beforeRegister() {
//                let is = this.constructor.name.replace(/\W+/g, '-')
//                    .replace(/([a-z\d])([A-Z])/g, '$1-$2').toLowerCase();
//                this.is = is;
//                this.properties = {
//                    posts: Array
//                };
//            }
//        }
//
//        Polymer(BlogPage);

    })();

</script>
