<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="featured-people">
    <template>
        <style include="shared-styles">
            :host {
                display: block;
            }

            .container {
                padding-bottom: 30px;
            }

            .people-wraper {
                margin-top: 40px;
            }

            .fe-people-img {
                height: 70px;
                width: 70px;
            }

            .fe-people-name {
                margin-top: 5px;
                padding: 0 16px;
                line-height: .9;
            }

            .fe-people-company {
                padding: 0 16px;
                display: block;
                font-size: .7em;
                line-height: 1.8;
            }

            .block-link {
                margin-top: 25px;
                display: block;
                color: inherit;
                font-size: .9em;
            }

            @media (max-width: 960px) {
                .fe-people:nth-child(1),
                .fe-people:nth-child(2) {
                    margin-bottom: 40px;
                }
            }

            @media (min-width: 601px) {
                .fe-people-img {
                    height: 120px;
                    width: 120px;
                }
            }
        </style>
        <div class="container text-center">
            <h4 class="heading">Rockstar Speakers</h4>
            <div class="flex wrap layout horizontal people-wraper">
                <template is="dom-repeat" items="[[featuredPeople]]" as="person">
                    <div class="fe-people two-column-xs">
                        <iron-image src="[[person.photoUrl]]" class="fe-people-img placeholder-color img-circle" preload fade sizing="cover"></iron-image>
                        <h4 class="fe-people-name">
                            <span>[[person.name]]</span>
                        </h4>
                        <span class="fe-people-company">[[person.company]]</span>
                    </div>
                </template>
            </div>
            <div>
                <a data-route="speakers" href="/speakers" class="block-link">
                    <paper-button>View all speakers</paper-button>
                </a>
            </div>
        </div>
    </template>
    <script>
    (function () {
        'use strict';

        class FeaturedPeople {
            beforeRegister() {
                let is = this.constructor.name.replace(/\W+/g, '-')
                    .replace(/([a-z\d])([A-Z])/g, '$1-$2').toLowerCase();
                this.is = is;
                this.properties = {
                    people: {
                        type: Array,
                        observer: '_peopleChanged'
                    }
                };
            }
            _peopleChanged() {
                let filteredPeople = [];
                for (var i = 0; i < this.people.length; i++) {
                    if (this.people[i].featured) {
                        filteredPeople.push(this.people[i]);
                    }
                }
                this.featuredPeople = this._randomOrder(filteredPeople).slice(0, 4);
            }
            _randomOrder(array) {
                return array.sort(function() {
                    return 0.5 - Math.random();
                });
            }
        }

        Polymer(FeaturedPeople);
    })();
    </script>
</dom-module>
