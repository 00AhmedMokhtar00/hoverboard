<link rel="import" href="../../../../bower_components/polymer/polymer.html">

<link rel="import" href="../../../../bower_components/marked-element/marked-element.html">

<dom-module id="latest-posts">
    <template>
        <style include="shared-styles"></style>
        <style>
            :host {
                display: block;
            }
            .title {
                color: var(--default-primary-color);
                font-size: 24px;
                line-height: 1.2
            }

            a {
                color: var(--default-primary-color);
                font-size: 16px;
            }
        </style>
        <div class="container">
            <h4 class="heading text-center">Latest news</h4>
            <div class="layout vertical-horizontal">
                <div class="flex-5">
                    <span class="title block">[[news.0.title]]</span>
                    <marked-element markdown="[[news.0.brief]]"></marked-element>
                    <a data-route$="[[news.0.dataRoute]]" href$="[[news.0.url]]" dynamic-link>Continue reading</a>
                </div>
                <span class="flex"></span>
                <div class="flex-5 second-block">
                    <span class="title block">[[news.1.title]]</span>
                    <marked-element markdown="[[news.1.brief]]"></marked-element>
                    <a data-route$="[[news.1.dataRoute]]" href$="[[news.1.url]]" dynamic-link>Continue reading</a>
                </div>
            </div>
        </div>
    </template>
    <script>
        (function() {
            'use strict';

            class LatestPosts {
                beforeRegister() {
                    let is = this.constructor.name.replace(/\W+/g, '-')
                        .replace(/([a-z\d])([A-Z])/g, '$1-$2').toLowerCase();
                    this.is = is;
                    this.properties = {
                        posts: {
                            type: Array,
                            observer: '_postsChanged'
                        }
                    };
                }
                _postsChanged() {
                    let temp = this.posts.reverse().slice(0, 2);
                    for (let i = 0, len = temp.length; i < len; i++) {
                        temp[i].url = '/blog/' + temp[i].titleUrl;
                        temp[i].dataRoute = 'blog/' + temp[i].titleUrl;
                    }
                    this.news = temp;
                }
            }

            Polymer(LatestPosts);
        })();
    </script>
</dom-module>
