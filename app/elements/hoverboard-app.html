<link rel="import" href="../../bower_components/polymer/polymer.html">

<!-- Iron elements -->
<link rel="import" href="../../bower_components/iron-flex-layout/classes/iron-flex-layout.html">
<link rel="import" href="../../bower_components/iron-image/iron-image.html">

<!-- Paper elements -->
<link rel="import" href="../../bower_components/paper-scroll-header-panel/paper-scroll-header-panel.html">
<link rel="import" href="../../bower_components/paper-drawer-panel/paper-drawer-panel.html">
<link rel="import" href="../../bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-menu/paper-menu.html">

<!-- Neon elements -->
<link rel="import" href="../../bower_components/neon-animation/neon-animated-pages.html">

<!-- Routing -->
<link rel="import" href="routing.html">

<!-- Theme -->
<link rel="import" href="../themes/hoverboard-theme/theme.html">

<!-- Custom elements -->
<link rel="import" href="app-data/app-data.html">
<link rel="import" href="blocks/hero-block/hero-block.html">
<link rel="import" href="blocks/hero-content/hero-content.html">


<link rel="import" href="pages/home-page.html">
<link rel="import" href="pages/blog-page.html">
<link rel="import" href="pages/post-page.html">


<dom-module id="hoverboard-app">
    <template>
        <style include="shared-styles"></style>
        <style>
            :host {
                display: block;
            }
            .logo {
                height: 100px;
                max-width: 100%;
            }
            .slogan,
            .dates {
                margin-top: 20px;
                font-size: 17px;
                font-weight: 400;
                text-transform: uppercase;
                letter-spacing: .09em;
                line-height: 1;
            }
            .description {
                margin-top: 20px;
            }

            .links {
                margin: 40px 0 10px;
            }

            .right-section {
                margin-top: 20px;
            }
        </style>
        <app-data speakers="{{speakers}}" sessions="{{sessions}}" posts="{{posts}}" partners="{{partners}}" schedule="{{schedule}}"></app-data>

        <paper-drawer-panel id="paperDrawerPanel" responsive-width="599px" force-narrow>
            <!-- Drawer Scroll Header Panel -->
            <paper-scroll-header-panel class="Drawer" drawer>
                <!-- Drawer Toolbar -->
                <paper-toolbar class="tall">
                    <div class="top">
                        <img class="Drawer-logo" src="{$ baseurl $}/images/logo-white.svg" alt="{$ title $}">
                    </div>
                    <div class="bottom">
                        <span class="Drawer-bottom">{$ dates $}
                            <br>{$ location.short $}</span>
                    </div>
                </paper-toolbar>

                <!-- Drawer Content -->
                <!-- Navigation -->
                <nav>
                    <paper-menu class="Drawer-navigation list" attr-for-selected="data-route" selected="{{route}}" on-iron-select="_onDataRouteClick">
                        {% for nav in navigation %}
                        <a class="layout horizontal center" data-route="{$ nav.route $}" href="{$ nav.permalink $}">{$ nav.text $}</a>
                        {% endfor %}
                    </paper-menu>
                </nav>
            </paper-scroll-header-panel>

            <!-- Main Area -->
            <div class="Main scroll" main>
                <hero-block route="{{route}}" font-color="{{_heroSettings.2}}" background-color="{{_heroSettings.0}}" tab-font-color="{{_heroSettings.3}}" tab-bar-color="{{_heroSettings.4}}" hide-logo="{{_equal(route, 'home')}}">
                    <template is="dom-if" if="{{_equal(route, 'home')}}">
                        <div class="top-section hero">
                            <div class="layout vertical-horizontal">
                                <div class="flex center-content-xs">
                                    <img class="logo" src="{$ baseurl $}/images/logo.svg" alt="GDG DevFest 2015">
                                    <p class="dates bold">October 23-24, Lviv</p>
                                    <p class="description">The biggest Google tech conference in Ukraine carefully crafted for you by GDG community! All about Android, Web and Cloud from the world experts</p>
                                    <p class="slogan">Think out of the box. Create what you want!</p>
                                    <div class="links layout horizontal align-pb-block">
                                        <paper-button noink on-tap="playVideo">
                                            Watch a video
                                        </paper-button>
                                        <a href="https://plus.google.com/events/gallery/cc6tosp4ohkp6qj9pg5jb4g6o3k?sort=1" target="_blank">
                                            <paper-button class="colorful" raised>
                                                View photos
                                            </paper-button>
                                        </a>
                                    </div>
                                </div>
                                <div class="flex relative right-section">
                                    <iron-image class="fit" src="{$ baseurl $}/images/lviv.svg" sizing="contain"></iron-image>
                                </div>
                            </div>
                        </div>
                    </template>
                    <template is="dom-if" if="{{_equal(route, 'blog')}}">
                        <hero-content title="Blog"></hero-content>
                    </template>
                    <!--<template is="dom-if" if="{{_equal(route, 'schedule')}}">-->
                        <!--<hero-content title="Schedule"></hero-content>-->
                    <!--</template>-->
                    <!--<template is="dom-if" if="{{_equal(route, 'speakers')}}">-->
                        <!--<hero-content title="Speakers"></hero-content>-->
                    <!--</template>-->
                </hero-block>

                <!-- Main Content -->
                <neon-animated-pages class="Main-content" attr-for-selected="data-route" selected="{{route}}" animate-initial-selection>
                    <home-page class="Page" data-route="home" people="{{speakers}}" posts="{{posts}}" logos="{{partners}}"></home-page>
                    <blog-page class="Page" data-route="blog" posts="{{posts}}"></blog-page>
                    <post-page class="Page" data-route="post" post-id="[[params.id]]" posts="{{posts}}"></post-page>
                </neon-animated-pages>
            </div>
        </paper-drawer-panel>
    </template>
    <script>
        (function() {
            'use strict';

            class HoverboardApp {
                beforeRegister() {
                    let is = this.constructor.name.replace(/\W+/g, '-')
                        .replace(/([a-z\d])([A-Z])/g, '$1-$2').toLowerCase();
                    this.is = is;
                    this.properties = {
                        route: {
                            type: String,
                            value: 'home',
                            observer: '_routerChanged'
                        },
                        _heroSettings: Array,
                        _stylesMap: {
                            type: Object,
                            value: function() {
                                return {
                                    {% for nav in navigation %}
                                    '{$ nav.route $}': {$ nav.styleSettings | dump $}{% if not loop.last %},{% endif %}
                                    {% endfor %}
                                };
                            }
                        }
                    };
                }
                _onDataRouteClick() {
                    this.$.paperDrawerPanel.closeDrawer();
                }
                _routerChanged() {
                    if(this._stylesMap) {
                        this._heroSettings = this._stylesMap[this.route];
                    }
                }
                _equal(value1, value2) {
                    if(!Array.isArray(value2)) {
                        value2 = [].concat(value2);
                    }
                    return value2.indexOf(value1) !== -1;
                }
            }

            Polymer(HoverboardApp);
        })();
    </script>
</dom-module>
